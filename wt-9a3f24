<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Work Timer</title>
<style>
:root { color-scheme: dark; }
body{
  margin:0;height:100vh;display:flex;align-items:center;justify-content:center;
  background:#0b0d10;color:#e8eef5;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",sans-serif;
}
.card{
  width:min(520px,94vw);
  background:rgba(255,255,255,.03);
  border:1px solid rgba(255,255,255,.08);
  border-radius:16px;
  padding:18px;
}
.title{font-size:13px;opacity:.7;letter-spacing:.08em}
.time{
  font-size:56px;font-variant-numeric:tabular-nums;
  margin:8px 0;
}
.row{display:flex;gap:10px;flex-wrap:wrap;font-size:13px;opacity:.85}
.pill{
  border:1px solid rgba(255,255,255,.12);
  padding:6px 10px;border-radius:999px;
}
.btns{display:flex;gap:10px;margin-top:12px}
button{
  padding:10px 14px;border-radius:12px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.15);
  color:#fff;font-weight:600;cursor:pointer;
}
.primary{background:rgba(86,156,255,.25)}
.danger{background:rgba(255,86,86,.18)}
</style>
</head>
<body>
<div class="card">
  <div class="title">WORK TIMER</div>
  <div class="time" id="now">00:00:00</div>

  <div class="row">
    <div class="pill">今日: <span id="day">00:00:00</span></div>
    <div class="pill">今週: <span id="week">00:00:00</span></div>
    <div class="pill">通算: <span id="all">00:00:00</span></div>
  </div>

  <div class="btns">
    <button class="primary" id="toggle">Start</button>
    <button id="add">+ 加算</button>
    <button class="danger" id="reset">Reset</button>
  </div>
</div>

<script>
const KEY="chappy_timer_v2";
const now=()=>Date.now();
const fmt=(ms)=>{
  const s=Math.floor(ms/1000);
  return [s/3600,s/60%60,s%60]
    .map(v=>String(Math.floor(v)).padStart(2,"0")).join(":");
};
const today=()=>new Date().toISOString().slice(0,10);
const week=()=>{
  const d=new Date();const n=d.getDay()||7;
  d.setDate(d.getDate()-n+1);
  return d.toISOString().slice(0,10);
};
let st=JSON.parse(localStorage.getItem(KEY)||"{}");
st={day:today(),week:week(),run:false,start:0,cur:0,dayT:st.dayT||0,weekT:st.weekT||0,allT:st.allT||0,...st};

const rollover=()=>{
  if(st.day!==today()){st.day=today();st.dayT=0;}
  if(st.week!==week()){st.week=week();st.weekT=0;}
};

const save=()=>localStorage.setItem(KEY,JSON.stringify(st));

setInterval(()=>{
  rollover();
  let e=st.cur+(st.run?(now()-st.start):0);
  nowEl.textContent=fmt(e);
  dayEl.textContent=fmt(st.dayT+e);
  weekEl.textContent=fmt(st.weekT+e);
  allEl.textContent=fmt(st.allT+e);
},200);

toggle.onclick=()=>{
  rollover();
  if(!st.run){st.run=true;st.start=now();}
  else{st.cur+=now()-st.start;st.run=false;}
  save();
};

add.onclick=()=>{
  rollover();
  let e=st.cur+(st.run?(now()-st.start):0);
  st.dayT+=e;st.weekT+=e;st.allT+=e;
  st.cur=0;st.start=now();
  save();
};

reset.onclick=()=>{
  st.run=false;st.cur=0;save();
};

const nowEl=now,dayEl=day,weekEl=week,allEl=all;
</script>
</body>
</html>
